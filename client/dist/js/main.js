Backbone.Model.prototype.idAttribute="_id";var Post=Backbone.Model.extend({defaults:{titulo:"",formato:"",fonte:""}}),Posts=Backbone.Collection.extend({url:"http://localhost:3000/api/posts"}),posts=new Posts,PostView=Backbone.View.extend({model:new Post,tagName:"tr",initialize:function(){this.template=_.template($(".posts-list-template").html())},events:{"click .delete-post":"delete"},delete:function(){this.model.destroy({success:function(t){console.log("Successfully DELETED blog with _id: "+t.toJSON()._id)},error:function(t){console.log("Failed to delete blog!")}})},render:function(){return this.$el.html(this.template(this.model.toJSON())),this}}),PostsView=Backbone.View.extend({model:posts,el:$(".posts-list"),initialize:function(){var t=this;this.model.on("add",this.render,this),this.model.on("change",function(){setTimeout(function(){t.render()},30)},this),this.model.on("remove",this.render,this),this.model.fetch({success:function(t){_.each(t.toJSON(),function(t){console.log("Successfully GOT post with _id: "+t._id)})},error:function(){console.log("Failed to get posts!")}})},render:function(){var t=this;return this.$el.html(""),_.each(this.model.toArray(),function(e){t.$el.append(new PostView({model:e}).render().$el)}),this}}),postsView=new PostsView;$(document).ready(function(){$(".add-post").on("click",function(){var t=new Post({formato:$(".formato-input").val(),fonte:$(".fonte-input").val()});$(".formato-input").val(""),$(".fonte-input").val(""),posts.add(t),t.save(null,{success:function(t){console.log("Successfully SAVED post with _id: "+t.toJSON()._id)},error:function(t){console.log("Failed to save post!"+t)}}),setTimeout(function(){location.reload()},1e3)})});